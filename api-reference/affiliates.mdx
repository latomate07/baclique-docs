# Affiliates API

Manage affiliates within your campaigns.

## Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/v1/campaigns/:campaign_id/affiliates` | List affiliates |
| POST | `/v1/campaigns/:campaign_id/affiliates` | Add an affiliate |
| DELETE | `/v1/campaigns/:campaign_id/affiliates/:affiliate_id` | Remove an affiliate |

---

## List Affiliates

Get all affiliates for a specific campaign.

```bash
GET /v1/campaigns/:campaign_id/affiliates
```

### Query Parameters

| Param | Type | Default | Description |
|-------|------|---------|-------------|
| status | string | - | Filter: `active`, `pending`, `rejected` |
| limit | number | 50 | Results per page |
| offset | number | 0 | Pagination offset |

### Response

```json
{
  "affiliates": [
    {
      "id": "aff_user123",
      "email": "john@example.com",
      "name": "John Doe",
      "status": "active",
      "unique_link": "https://c.baclique.com/summer-x7k2",
      "affiliate_code": "summer-x7k2",
      "joined_at": "2024-01-18T14:20:00Z",
      "stats": {
        "clicks": 1520,
        "conversions": 45,
        "revenue": 4500.00,
        "pending_commission": 450.00
      }
    }
  ],
  "pagination": {
    "limit": 50,
    "offset": 0,
    "total": 12
  }
}
```

---

## Add Affiliate

Invite an affiliate to your campaign by email.

```bash
POST /v1/campaigns/:campaign_id/affiliates
Content-Type: application/json
```

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| email | string | ✅ | Affiliate's email address |

### Example

```bash
curl -X POST https://api.baclique.com/v1/campaigns/cmp_abc123/affiliates \
  -H "Authorization: Bearer sk_live_YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"email": "affiliate@example.com"}'
```

### Response

```json
{
  "success": true,
  "affiliate": {
    "id": "aff_xyz789",
    "email": "affiliate@example.com",
    "status": "active",
    "affiliate_code": "summer-k3m9",
    "unique_link": "https://c.baclique.com/summer-k3m9"
  }
}
```

### Behavior

- If the email is already a BaClique user → Added immediately
- If new email → User created and invitation sent
- For **private campaigns** → Affiliate is auto-approved (no pending state)

---

## Remove Affiliate

Remove an affiliate from a campaign.

```bash
DELETE /v1/campaigns/:campaign_id/affiliates/:affiliate_id
```

### Example

```bash
curl -X DELETE https://api.baclique.com/v1/campaigns/cmp_abc123/affiliates/aff_xyz789 \
  -H "Authorization: Bearer sk_live_YOUR_API_KEY"
```

### Response

```json
{
  "success": true,
  "message": "Affiliate removed from campaign"
}
```

> ⚠️ **Note:** This removes the affiliate from the campaign but does not delete their historical data (clicks, conversions, commissions).

---

## Affiliate Statuses

| Status | Description |
|--------|-------------|
| `active` | Affiliate can generate links and earn commissions |
| `pending` | Waiting for approval (private campaigns only) |
| `rejected` | Application rejected by creator |

---

## Code Examples

### JavaScript - List All Affiliates

```javascript
async function listAffiliates(campaignId) {
  const response = await fetch(
    `https://api.baclique.com/v1/campaigns/${campaignId}/affiliates`,
    {
      headers: {
        'Authorization': `Bearer ${process.env.BACLIQUE_API_KEY}`
      }
    }
  );
  
  return response.json();
}
```

### Python - Add Affiliate

```python
import requests

def add_affiliate(campaign_id, email):
    response = requests.post(
        f"https://api.baclique.com/v1/campaigns/{campaign_id}/affiliates",
        headers={
            "Authorization": f"Bearer {os.environ['BACLIQUE_API_KEY']}",
            "Content-Type": "application/json"
        },
        json={"email": email}
    )
    return response.json()
```
